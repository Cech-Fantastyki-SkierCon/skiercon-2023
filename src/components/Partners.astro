---
import type { PartnerDto } from '../__gen-api'

export interface Props {
  partners: PartnerDto[]
  title: string
}

const { title, partners } = Astro.props
const big = partners.filter(p => p.size === 'large')
const medium = partners.filter(p => p.size === 'medium')
const small = partners.filter(p => p.size === 'small')
---

{
  [big, medium, small]
    .filter(x => x.length > 0)
    .map(p => {
      return (
        <>
          <h2 class="title">{title}</h2>
          <div class:list={['images', `images--${p[0].size}`]}>
            {p.map(partner => {
              return (
                <a class="img-wrap" href={partner.href} title={partner.name}>
                  <img
                    src={partner.img.url}
                    alt={partner.img.alt || partner.name}
                  />
                </a>
              )
            })}
          </div>
        </>
      )
    })
}

<style lang="scss">
  @use 'sass-mq' as * with (
    $breakpoints: (
      mobile: 400px,
      tablet: 768px,
      desktop: 1140px,
    )
  );

  .title,
  .subtitle {
    text-align: center;
  }

  .title {
    font-size: 36px;
  }

  .images {
    display: flex;
    flex-wrap: wrap;
    justify-content: center;

    margin: 40px 0;

    img {
      object-fit: cover;
      height: 100%;
    }

    &--large {
      .img-wrap {
        width: calc(100% / 3 - 20px);
        height: 350px;

        @include mq($until: desktop) {
          width: 100%;
          height: auto;
        }
      }
    }

    &--medium {
      .img-wrap {
        width: calc(100% / 5 - 24px);
        height: 200px;

        @include mq($until: desktop) {
          width: calc(100% / 3 - 20px);
        }

        @include mq($until: tablet) {
          width: calc(100% / 2 - 20px);
        }
      }
    }

    &--small {
      .img-wrap {
        width: calc(100% / 7 - 30px);
        height: 120px;

        @include mq($until: desktop) {
          width: calc(100% / 5 - 20px);
          height: 100px;
        }

        @include mq($until: tablet) {
          width: calc(100% / 3 - 20px);
          height: 80px;
        }
      }
    }
  }
</style>
